{
  "description": {
    "spec-version": {
      "Right": ">=1.10"
    },
    "package": {
      "name": "streaming-bytestring",
      "version": [
        0,
        1,
        0,
        0
      ]
    },
    "license": {
      "Right": "BSD3"
    },
    "license-files": [
      "LICENSE"
    ],
    "copyright": "",
    "maintainer": "what_is_it_to_do_anything@yahoo.com",
    "author": "michaelt",
    "stability": "",
    "tested-with": [],
    "homepage": "",
    "pkg-url": "",
    "bug-reports": "",
    "source-repos": [],
    "synopsis": "Effectful sequences of bytes.",
    "description": "This is an implementation of effectful, monadic bytestrings,\nadequate for non-lazy-io.\n\nInteroperation with @pipes@ uses this isomorphism:\n\n> Streaming.unfoldrChunks Pipes.next :: Monad m => Producer ByteString m r -> ByteString m r\n> Pipes.unfoldr Streaming.nextChunk  :: Monad m => ByteString m r -> Producer ByteString m r\n\nInteroperation with @io-streams@ is thus:\n\n> IOStreams.unfoldM Streaming.unconsChunk :: ByteString IO () -> IO (InputStream ByteString)\n> Streaming.reread IOStreams.read         :: InputStream ByteString -> ByteString IO ()\n\nand similarly for other streaming io libraries.\n\nThe implementation follows the\ndetails of @Data.ByteString.Lazy@ and @Data.ByteString.Lazy.Char8@\nas far as is possible, substituting the type\n\n> data ByteString m r = Empty r\n>                     | Chunk Strict.ByteString (ByteString m r)\n>                     | Go (m (ByteString m r))\n\nfor the type\n\n> data ByteString = Empty\n>                 | Chunk Strict.ByteString ByteString\n\nfound in @Data.ByteString.Lazy.Internal@. (Constructors are necessarily hidden in\ninternal modules in both cases.) As a lazy bytestring is implemented internally\nby a sort of list of strict bytestring chunks, a streaming bytestring is\nimplemented as a /producer/ or /generator/ of strict bytestring chunks.\n\nSomething like this alteration of type is of course obvious and mechanical, once the idea of\nan effectful bytestring type is contemplated and lazy io is rejected.\nIndeed it seems that this is the proper expression of what was\nintended by lazy bytestrings to begin with. The documentation, after all,\nreads\n\n* \\\"A key feature of lazy ByteStrings is the means to manipulate large or\nunbounded streams of data without requiring the entire sequence to be\nresident in memory. To take advantage of this you have to write your\nfunctions in a lazy streaming style, e.g. classic pipeline composition.\nThe default I/O chunk size is 32k, which should be good in most circumstances.\\\"\n\n... which is very much the idea of this library: the default chunk size for\n'hGetContents' and the like follows @Data.ByteString.Lazy@ and operations\nlike @lines@ and @append@ and so on are tailored not to increase chunk size.\n\nIt is natural to think that\nthe direct, naive, monadic formulation of such a type\nwould necessarily make things much slower. This appears to be a prejudice.\nFor example, passing a large file of short lines through\nthis benchmark transformation\n\n> Lazy.unlines      . map    (\\bs -> \"!\"       <> Lazy.drop 5 bs)       . Lazy.lines\n> Streaming.unlines . S.maps (\\bs -> chunk \"!\" >> Streaming.drop 5 bs)  . Streaming.lines\n\ngives pleasing results like these\n\n> $  time ./benchlines lazy >> /dev/null\n> real\t0m2.097s\n> ...\n> $  time ./benchlines streaming >> /dev/null\n> real\t0m1.930s\n\nMore typical, perhaps, are the results for the more\nsophisticated operation\n\n> Lazy.intercalate \"!\\n\"      . Lazy.lines\n> Streaming.intercalate \"!\\n\" . Streaming.lines\n\n> time ./benchlines lazy >> /dev/null\n> real\t0m1.250s\n> ...\n> time ./benchlines streaming >> /dev/null\n> real\t0m1.531s\n\nThe pipes environment (to which this library basically belongs)\nwould express the latter as\n\n> Pipes.intercalates (Pipes.yield \"!\\n\") . view Pipes.lines\n\nmeaning almost exactly what we mean above, but with results like this\n\n>  time ./benchlines pipes >> /dev/null\n>  real\t0m6.353s\n\nThe difference, I think, is mostly that this library depends\nthe @streaming@ library, which is used in place of @free@ to\nexpress the splitting and division of byte streams.\n\nIndeed even if I unwrap and re-wrap with the above-mentioned isomorphism\n\n> Pipes.unfoldr Streaming.nextChunk . Streaming.intercalate \"!\\n\" . Streaming.lines . Streaming.unfoldrChunks Pipe.next\n\nI get an excellent speed-up:\n\n> $  time ./benchlines pipes_stream >> /dev/null\n> real\t0m3.393s\n\nThough we barely alter signatures in @Data.ByteString.Lazy@\nmore than is required\nby the types, the point of view that emerges is very much that of\n@pipes-bytestring@ and @pipes-group@. In particular\nwe have the correspondences\n\n> Lazy.splitAt      :: Int -> ByteString              -> (ByteString, ByteString)\n> Streaming.splitAt :: Int -> ByteString m r          -> ByteString m (ByteString m r)\n> Pipes.splitAt     :: Int -> Producer ByteString m r -> Producer ByteString m (Producer ByteString m r)\n\nand\n\n> Lazy.lines      :: ByteString -> [ByteString]\n> Streaming.lines :: ByteString m r -> Stream (ByteString m) m r\n> Pipes.lines     :: Producer ByteString m r -> FreeT (Producer ByteString m) m r\n\nwhere the @Stream@ type expresses the sequencing of @ByteString m _@ layers\nwith the usual \\'free monad\\' sequencing.\n\nIf you are unfamiliar with this\nway of structuring material you might take a look at the tutorial for\n<http://hackage.haskell.org/package/pipes-group-1.0.2/docs/Pipes-Group-Tutorial.html pipes-group>\nand the examples in the documentation for the streaming library. See also\n<https://gist.github.com/michaelt/6c6843e6dd8030e95d58 these>\nimplementations of the shell-like examples from the @io-streams@ tutorial.\n",
    "category": "Data",
    "custom-fields": [],
    "build-type-raw": "Simple",
    "custom-setup": null,
    "library": null,
    "sublibraries": [],
    "executables": [],
    "foreign-libs": [],
    "test-suites": [],
    "benchmarks": [],
    "data-files": [],
    "data-dir": ".",
    "extra-source-files": [
      "ChangeLog.md"
    ],
    "extra-tmp-files": [],
    "extra-doc-files": []
  },
  "library": {
    "condTreeData": {
      "name": {},
      "exposed-modules": [
        [
          "Data",
          "ByteString",
          "Streaming"
        ],
        [
          "Data",
          "ByteString",
          "Streaming",
          "Char8"
        ],
        [
          "Data",
          "ByteString",
          "Streaming",
          "Internal"
        ],
        [
          "Data",
          "ByteString",
          "Streaming",
          "HTTP"
        ],
        [
          "Data",
          "Attoparsec",
          "ByteString",
          "Streaming"
        ]
      ],
      "re-exported-modules": [],
      "signatures": [],
      "exposed": true,
      "visibility": "LibraryVisibilityPublic",
      "build-info": {
        "buildable": true,
        "buildTools": [],
        "buildToolDepends": [],
        "cppOptions": [],
        "asmOptions": [],
        "cmmOptions": [],
        "ccOptions": [],
        "cxxOptions": [],
        "ldOptions": [],
        "pkgconfigDepends": [],
        "frameworks": [],
        "extraFrameworkDirs": [],
        "asmSources": [],
        "cmmSources": [],
        "cSources": [],
        "cxxSources": [],
        "jsSources": [],
        "hsSourceDirs": [],
        "otherModules": [],
        "virtualModules": [],
        "autogenModules": [],
        "defaultLanguage": "Haskell2010",
        "otherLanguages": [],
        "defaultExtensions": [],
        "otherExtensions": [
          {
            "enable-extension": "CPP"
          },
          {
            "enable-extension": "BangPatterns"
          },
          {
            "enable-extension": "ForeignFunctionInterface"
          },
          {
            "enable-extension": "DeriveDataTypeable"
          },
          {
            "enable-extension": "Unsafe"
          }
        ],
        "oldExtensions": [],
        "extraLibs": [],
        "extraGHCiLibs": [],
        "extraBundledLibs": [],
        "extraLibFlavours": [],
        "extraDynLibFlavours": [],
        "extraLibDirs": [],
        "includeDirs": [],
        "includes": [],
        "autogenIncludes": [],
        "installIncludes": [],
        "options": [
          [],
          []
        ],
        "profOptions": [
          [],
          []
        ],
        "sharedOptions": [
          [],
          []
        ],
        "staticOptions": [
          [],
          []
        ],
        "customFieldsBI": [],
        "targetBuildDepends": [
          {
            "package-name": "base",
            "version-range": ">=4.8 && <4.9",
            "library": [
              {}
            ]
          },
          {
            "package-name": "bytestring",
            "version-range": ">=0.10 && <0.11",
            "library": [
              {}
            ]
          },
          {
            "package-name": "deepseq",
            "version-range": ">=1.4 && <1.5",
            "library": [
              {}
            ]
          },
          {
            "package-name": "syb",
            "version-range": ">=0.5 && <0.6",
            "library": [
              {}
            ]
          },
          {
            "package-name": "mtl",
            "version-range": ">=2.2 && <2.3",
            "library": [
              {}
            ]
          },
          {
            "package-name": "mmorph",
            "version-range": ">=1.0 && <1.1",
            "library": [
              {}
            ]
          },
          {
            "package-name": "attoparsec",
            "version-range": "-any",
            "library": [
              {}
            ]
          },
          {
            "package-name": "transformers",
            "version-range": "-any",
            "library": [
              {}
            ]
          },
          {
            "package-name": "foldl",
            "version-range": "-any",
            "library": [
              {}
            ]
          },
          {
            "package-name": "streaming",
            "version-range": "-any",
            "library": [
              {}
            ]
          },
          {
            "package-name": "http-client",
            "version-range": "-any",
            "library": [
              {}
            ]
          },
          {
            "package-name": "http-client-tls",
            "version-range": "-any",
            "library": [
              {}
            ]
          }
        ],
        "mixins": []
      }
    },
    "condTreeConstraints": [
      {
        "package-name": "base",
        "version-range": ">=4.8 && <4.9",
        "library": [
          {}
        ]
      },
      {
        "package-name": "bytestring",
        "version-range": ">=0.10 && <0.11",
        "library": [
          {}
        ]
      },
      {
        "package-name": "deepseq",
        "version-range": ">=1.4 && <1.5",
        "library": [
          {}
        ]
      },
      {
        "package-name": "syb",
        "version-range": ">=0.5 && <0.6",
        "library": [
          {}
        ]
      },
      {
        "package-name": "mtl",
        "version-range": ">=2.2 && <2.3",
        "library": [
          {}
        ]
      },
      {
        "package-name": "mmorph",
        "version-range": ">=1.0 && <1.1",
        "library": [
          {}
        ]
      },
      {
        "package-name": "attoparsec",
        "version-range": "-any",
        "library": [
          {}
        ]
      },
      {
        "package-name": "transformers",
        "version-range": "-any",
        "library": [
          {}
        ]
      },
      {
        "package-name": "foldl",
        "version-range": "-any",
        "library": [
          {}
        ]
      },
      {
        "package-name": "streaming",
        "version-range": "-any",
        "library": [
          {}
        ]
      },
      {
        "package-name": "http-client",
        "version-range": "-any",
        "library": [
          {}
        ]
      },
      {
        "package-name": "http-client-tls",
        "version-range": "-any",
        "library": [
          {}
        ]
      }
    ],
    "condTreeComponents": []
  }
}
